"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},componentHandler={upgradeDom:function(e,t){},upgradeElement:function(e,t){},upgradeElements:function(e){},upgradeAllRegistered:function(){},registerUpgradedCallback:function(e,t){},register:function(e){},downgradeElements:function(e){}};(componentHandler=function(){var e=[],t=[],s="mdlComponentConfigInternal_";function n(t,s){for(var n=0;n<e.length;n++)if(e[n].className===t)return void 0!==s&&(e[n]=s),e[n];return!1}function i(e){var t=e.getAttribute("data-upgraded");return null===t?[""]:t.split(",")}function a(e,t){return-1!==i(e).indexOf(t)}function o(e,t,s){if("CustomEvent"in window&&"function"==typeof window.CustomEvent)return new CustomEvent(e,{bubbles:t,cancelable:s});var n=document.createEvent("Events");return n.initEvent(e,t,s),n}function r(t,s){if(void 0===t&&void 0===s)for(var i=0;i<e.length;i++)r(e[i].className,e[i].cssClass);else{var a=t;if(void 0===s){var o=n(a);o&&(s=o.cssClass)}for(var c=document.querySelectorAll("."+s),d=0;d<c.length;d++)l(c[d],a)}}function l(r,l){if(!("object"===(void 0===r?"undefined":_typeof(r))&&r instanceof Element))throw new Error("Invalid argument provided to upgrade MDL element.");var c=o("mdl-componentupgrading",!0,!0);if(r.dispatchEvent(c),!c.defaultPrevented){var d=i(r),u=[];if(l)a(r,l)||u.push(n(l));else{var h=r.classList;e.forEach(function(e){h.contains(e.cssClass)&&-1===u.indexOf(e)&&!a(r,e.className)&&u.push(e)})}for(var g,m=0,p=u.length;m<p;m++){if(!(g=u[m]))throw new Error("Unable to find a registered component for the given class.");d.push(g.className),r.setAttribute("data-upgraded",d.join(","));var f=new g.classConstructor(r);f[s]=g,t.push(f);for(var _=0,v=g.callbacks.length;_<v;_++)g.callbacks[_](r);g.widget&&(r[g.className]=f);var y=o("mdl-componentupgraded",!0,!1);r.dispatchEvent(y)}}}function c(e){if(e){var n=t.indexOf(e);t.splice(n,1);var i=e.element_.getAttribute("data-upgraded").split(","),a=i.indexOf(e[s].classAsString);i.splice(a,1),e.element_.setAttribute("data-upgraded",i.join(","));var r=o("mdl-componentdowngraded",!0,!1);e.element_.dispatchEvent(r)}}return{upgradeDom:r,upgradeElement:l,upgradeElements:function e(t){Array.isArray(t)||(t=t instanceof Element?[t]:Array.prototype.slice.call(t));for(var s,n=0,i=t.length;n<i;n++)(s=t[n])instanceof HTMLElement&&(l(s),s.children.length>0&&e(s.children))},upgradeAllRegistered:function(){for(var t=0;t<e.length;t++)r(e[t].className)},registerUpgradedCallback:function(e,t){var s=n(e);s&&s.callbacks.push(t)},register:function(t){var i=!0;void 0===t.widget&&void 0===t.widget||(i=t.widget||t.widget);var a={classConstructor:t.constructor||t.constructor,className:t.classAsString||t.classAsString,cssClass:t.cssClass||t.cssClass,widget:i,callbacks:[]};if(e.forEach(function(e){if(e.cssClass===a.cssClass)throw new Error("The provided cssClass has already been registered: "+e.cssClass);if(e.className===a.className)throw new Error("The provided className has already been registered")}),t.constructor.prototype.hasOwnProperty(s))throw new Error("MDL component classes must not have "+s+" defined as a property.");n(t.classAsString,a)||e.push(a)},downgradeElements:function(e){var s=function(e){t.filter(function(t){return t.element_===e}).forEach(c)};if(e instanceof Array||e instanceof NodeList)for(var n=0;n<e.length;n++)s(e[n]);else{if(!(e instanceof Node))throw new Error("Invalid argument provided to downgrade MDL nodes.");s(e)}}}}()).ComponentConfigPublic,componentHandler.ComponentConfig,componentHandler.Component,componentHandler.upgradeDom=componentHandler.upgradeDom,componentHandler.upgradeElement=componentHandler.upgradeElement,componentHandler.upgradeElements=componentHandler.upgradeElements,componentHandler.upgradeAllRegistered=componentHandler.upgradeAllRegistered,componentHandler.registerUpgradedCallback=componentHandler.registerUpgradedCallback,componentHandler.register=componentHandler.register,componentHandler.downgradeElements=componentHandler.downgradeElements,window.componentHandler=componentHandler,window.componentHandler=componentHandler,window.addEventListener("load",function(){"classList"in document.createElement("div")&&"querySelector"in document&&"addEventListener"in window&&Array.prototype.forEach?(document.documentElement.classList.add("mdl-js"),componentHandler.upgradeAllRegistered()):(componentHandler.upgradeElement=function(){},componentHandler.register=function(){})}),function(){var e=function(e){this.element_=e,this.maxRows=this.Constant_.NO_MAX_ROWS,this.init()};window.MaterialTextfield=e,e.prototype.Constant_={NO_MAX_ROWS:-1,MAX_ROWS_ATTRIBUTE:"maxrows"},e.prototype.CssClasses_={LABEL:"mdl-textfield__label",INPUT:"mdl-textfield__input",IS_DIRTY:"is-dirty",IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_INVALID:"is-invalid",IS_UPGRADED:"is-upgraded",HAS_PLACEHOLDER:"has-placeholder"},e.prototype.onKeyDown_=function(e){var t=e.target.value.split("\n").length;13===e.keyCode&&t>=this.maxRows&&e.preventDefault()},e.prototype.onFocus_=function(e){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},e.prototype.onBlur_=function(e){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},e.prototype.onReset_=function(e){this.updateClasses_()},e.prototype.updateClasses_=function(){this.checkDisabled(),this.checkValidity(),this.checkDirty(),this.checkFocus()},e.prototype.checkDisabled=function(){this.input_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},e.prototype.checkDisabled=e.prototype.checkDisabled,e.prototype.checkFocus=function(){Boolean(this.element_.querySelector(":focus"))?this.element_.classList.add(this.CssClasses_.IS_FOCUSED):this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},e.prototype.checkFocus=e.prototype.checkFocus,e.prototype.checkValidity=function(){this.input_.validity&&(this.input_.validity.valid?this.element_.classList.remove(this.CssClasses_.IS_INVALID):this.element_.classList.add(this.CssClasses_.IS_INVALID))},e.prototype.checkValidity=e.prototype.checkValidity,e.prototype.checkDirty=function(){this.input_.value&&this.input_.value.length>0?this.element_.classList.add(this.CssClasses_.IS_DIRTY):this.element_.classList.remove(this.CssClasses_.IS_DIRTY)},e.prototype.checkDirty=e.prototype.checkDirty,e.prototype.disable=function(){this.input_.disabled=!0,this.updateClasses_()},e.prototype.disable=e.prototype.disable,e.prototype.enable=function(){this.input_.disabled=!1,this.updateClasses_()},e.prototype.enable=e.prototype.enable,e.prototype.change=function(e){this.input_.value=e||"",this.updateClasses_()},e.prototype.change=e.prototype.change,e.prototype.init=function(){if(this.element_&&(this.label_=this.element_.querySelector("."+this.CssClasses_.LABEL),this.input_=this.element_.querySelector("."+this.CssClasses_.INPUT),this.input_)){this.input_.hasAttribute(this.Constant_.MAX_ROWS_ATTRIBUTE)&&(this.maxRows=parseInt(this.input_.getAttribute(this.Constant_.MAX_ROWS_ATTRIBUTE),10),isNaN(this.maxRows)&&(this.maxRows=this.Constant_.NO_MAX_ROWS)),this.input_.hasAttribute("placeholder")&&this.element_.classList.add(this.CssClasses_.HAS_PLACEHOLDER),this.boundUpdateClassesHandler=this.updateClasses_.bind(this),this.boundFocusHandler=this.onFocus_.bind(this),this.boundBlurHandler=this.onBlur_.bind(this),this.boundResetHandler=this.onReset_.bind(this),this.input_.addEventListener("input",this.boundUpdateClassesHandler),this.input_.addEventListener("focus",this.boundFocusHandler),this.input_.addEventListener("blur",this.boundBlurHandler),this.input_.addEventListener("reset",this.boundResetHandler),this.maxRows!==this.Constant_.NO_MAX_ROWS&&(this.boundKeyDownHandler=this.onKeyDown_.bind(this),this.input_.addEventListener("keydown",this.boundKeyDownHandler));var e=this.element_.classList.contains(this.CssClasses_.IS_INVALID);this.updateClasses_(),this.element_.classList.add(this.CssClasses_.IS_UPGRADED),e&&this.element_.classList.add(this.CssClasses_.IS_INVALID),this.input_.hasAttribute("autofocus")&&(this.element_.focus(),this.checkFocus())}},componentHandler.register({constructor:e,classAsString:"MaterialTextfield",cssClass:"mdl-js-textfield",widget:!0})}(),function(){var e=function(e){this.element_=e,this.init()};window.MaterialTooltip=e,e.prototype.Constant_={},e.prototype.CssClasses_={IS_ACTIVE:"is-active",BOTTOM:"mdl-tooltip--bottom",LEFT:"mdl-tooltip--left",RIGHT:"mdl-tooltip--right",TOP:"mdl-tooltip--top"},e.prototype.handleMouseEnter_=function(e){var t=e.target.getBoundingClientRect(),s=t.left+t.width/2,n=t.top+t.height/2,i=this.element_.offsetWidth/2*-1,a=this.element_.offsetHeight/2*-1;this.element_.classList.contains(this.CssClasses_.LEFT)||this.element_.classList.contains(this.CssClasses_.RIGHT)?(s=t.width/2,n+a<0?(this.element_.style.top="0",this.element_.style.marginTop="0"):(this.element_.style.top=n+"px",this.element_.style.marginTop=a+"px")):s+i<0?(this.element_.style.left="0",this.element_.style.marginLeft="0"):(this.element_.style.left=s+"px",this.element_.style.marginLeft=i+"px"),this.element_.classList.contains(this.CssClasses_.TOP)?this.element_.style.top=t.top-this.element_.offsetHeight-10+"px":this.element_.classList.contains(this.CssClasses_.RIGHT)?this.element_.style.left=t.left+t.width+10+"px":this.element_.classList.contains(this.CssClasses_.LEFT)?this.element_.style.left=t.left-this.element_.offsetWidth-10+"px":this.element_.style.top=t.top+t.height+10+"px",this.element_.classList.add(this.CssClasses_.IS_ACTIVE)},e.prototype.hideTooltip_=function(){this.element_.classList.remove(this.CssClasses_.IS_ACTIVE)},e.prototype.init=function(){if(this.element_){var e=this.element_.getAttribute("for")||this.element_.getAttribute("data-mdl-for");e&&(this.forElement_=document.getElementById(e)),this.forElement_&&(this.forElement_.hasAttribute("tabindex")||this.forElement_.setAttribute("tabindex","0"),this.boundMouseEnterHandler=this.handleMouseEnter_.bind(this),this.boundMouseLeaveAndScrollHandler=this.hideTooltip_.bind(this),this.forElement_.addEventListener("mouseenter",this.boundMouseEnterHandler,!1),this.forElement_.addEventListener("touchend",this.boundMouseEnterHandler,!1),this.forElement_.addEventListener("mouseleave",this.boundMouseLeaveAndScrollHandler,!1),window.addEventListener("scroll",this.boundMouseLeaveAndScrollHandler,!0),window.addEventListener("touchstart",this.boundMouseLeaveAndScrollHandler))}},componentHandler.register({constructor:e,classAsString:"MaterialTooltip",cssClass:"mdl-tooltip"})}();var utils={parseSvg:function(e){var t=e;return(new DOMParser).parseFromString(t,"text/xml").documentElement},addElement:function(e,t,s,n,i,a){var o=document.createElement(e);if(t&&(o.className=t),s&&(o.id=s),(i||"number"==typeof i)&&(o.value=i),(n||"number"==typeof i)&&(o.textContent=n),a)for(var r in a)o.setAttribute(r,a[r]);return o},buildCustomDom:function(e){var t=document.implementation.createHTMLDocument();return t.documentElement.innerHTML=e,t},extend:function(e,t,s){var n,i={};if(e)for(n in t)i[n]=t[n];for(n in s)e?i[n]=s[n]:t[n]=s[n];return e?i:t}},_createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}();function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,s=Array(e.length);t<e.length;t++)s[t]=e[t];return s}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Search=function(){function e(){_classCallCheck(this,e),this.search=!1,this.tabs=!1,this.search_id="f_search",this.element=null,this.open="_blank",this.pressed=[],this.my_latest_tap=0,this.taps=0,this.lang="en",this.self=!1,this.background=!0,this.bg_animation=!0,this.touch=!0,this.search_engine="google",this.keys=["Control","Enter"],this.keys_tabs=["ArrowDown","ArrowUp"],this.shortcuts=["f:facebook.com"],this.exclude_urls=["linkedin.com"],this.tabs_collection=null,this.suggests_collection=null,this.suggests=[],this.suggest={id:0,request:"",typeCount:0},this.matches_request=[],this.suggests_limit=10,this.suggests_show=!1,this.search_engine_data={google:{origin:"https://google.by/",search:"search?q=",shortcut:"g",favicon:"img/google.png"},bing:{origin:"https://bing.com/",search:"search?q=",shortcut:"b",favicon:"img/bing.png"},yandex:{origin:"https://yandex.by/",search:"search/?text=",shortcut:"y",favicon:"img/yandex.png"},duckduck:{origin:"https://duckduckgo.com/",search:"?q=",shortcut:"d",favicon:"img/duckduck.png"},baidu:{origin:"http://baidu.com/",search:"s?wd=",shortcut:"du",favicon:"img/baidu.png"},youtube:{origin:"http://youtube.com/",search:"results?search_query=",shortcut:"yt",favicon:"img/youtube.png"},wikipedia:{origin:"http://wikipedia.org/",search:"w/index.php?search=",shortcut:"w",favicon:"img/wikipedia.png"},github:{origin:"http://github.com/",search:"search?utf8=✓&q=",shortcut:"gt",favicon:"img/github.png"}}}return _createClass(e,[{key:"appendSearch",value:function(){var e=this,t=utils.addElement("div","wrp-textfield fs-search is-hidden--fs-search mdl-shadow--4dp"),s=utils.addElement("div","mdl-textfield mdl-js-textfield mdl-textfield--floating-label"),n=utils.addElement("input","mdl-textfield__input",this.search_id,!1,!1,{autocomplete:"off"}),i=utils.addElement("label","mdl-textfield__label",!1,"en"===this.lang?"Search":"Введите запрос",!1,{for:this.search_id}),a=utils.addElement("span","mdl-textfield__close svg-icon","f_close_btn"),o=utils.addElement("span","mdl-textfield__search svg-icon","f_search_btn"),r=utils.addElement("div","mdl-textfield__suggests mdl-shadow--2d is-hidden--fs-search","suggests_search"),l=utils.addElement("ul","mdl-textfield__suggests-ul"),c=utils.addElement("div","shortcuts-list-img"),d=utils.addElement("ul","shortcuts-list-img__ul mdl-shadow--2dp is-hidden--fs-search"),u=utils.addElement("span","shortcuts-list-img__arrow svg-icon","f_arrow");Object.keys(this.search_engine_data).forEach(function(t,s){var n=utils.addElement("li","shortcuts-list-img__li"),i=utils.addElement("img","shortcuts-list-img__ico","search_icon_"+s,!1,!1,{src:chrome.extension.getURL(e.search_engine_data[t].favicon),"data-shortcut":e.search_engine_data[t].shortcut}),a=utils.addElement("div","mdl-tooltip mdl-tooltip--right",!1,e.search_engine_data[t].shortcut,!1,{"data-mdl-for":"search_icon_"+s});n.appendChild(i),n.appendChild(a),d.appendChild(n),setTimeout(function(){componentHandler.upgradeElement(a)},10)}),c.appendChild(u),c.appendChild(d),r.appendChild(l),s.appendChild(n),s.appendChild(i),s.appendChild(o),s.appendChild(a),s.appendChild(r),s.appendChild(c),t.appendChild(s),componentHandler.upgradeElement(s),document.documentElement.appendChild(t),this.element=document.getElementById(this.search_id)}},{key:"appendBackground",value:function(){var e=utils.addElement("div","layout-bg--fs-search layout-bg--animation is-hidden--fs-search","f_bg");document.documentElement.appendChild(e)}},{key:"addPrefixLangSearchEngine",value:function(){var e=this.search_engine_data.wikipedia.origin;this.search_engine_data.wikipedia.origin=e.replace(/^http:\/\//,"http://"+this.lang+".")}},{key:"docEvents",value:function(){for(var e=this,t=0;t<this.search_engine_data.length;t++);var s=["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"];document.addEventListener("keyup",function(t){var n=t.target.id;if(n&&n===e.search_id){if(-1===s.indexOf(t.key))e.saveMatchesRequest(e.element.value)?e.buildSuggests():e.removeSuggests();e.appendSearchEngineFavicon(t)}}),document.addEventListener("keydown",function(t){switch(t.target.id){case e.search_id:e.checkKeys(t,!0);break;default:var s=e.checkKeys(t);s&&e.sendMessage({query:"update",data:s})}}),document.addEventListener("touchstart",function(t){e.touch&&"VIDEO"!==t.target.tagName&&e.tap(t)}),document.addEventListener("click",function(t){var s=t.target.id?t.target:t.target.parentNode;switch(s.id){case"f_search_btn":e.openRequest(e.element.value);break;case"f_close_btn":e.search=!1,e.toggleSearch();break;case"f_arrow":e.toggleShortcutsListImg();break;default:if((s=t.target).classList.contains("shortcuts-list-img__ico")&&e.insertShortcutWithClick(s),s.classList.contains("mdl-textfield__suggests-button")){e.removeSuggest(s);break}if(s.classList.contains("mdl-textfield__suggests-text")){e.element.value+=s.textContent,e.openRequest(e.element.value);break}if(s.classList.contains("tab-nav__close"))e.sendMessage({query:"remove",data:+s.parentNode.dataset.id});else{for(;!s.classList.contains("tab-nav__tab");){if("HTML"===s.tagName)return;s=s.parentNode}e.sendMessage({query:"update",data:+s.dataset.id})}}})}},{key:"tap",value:function(e){var t="touchstart"===e.type,s=(new Date).getTime(),n=s-this.my_latest_tap;this.taps+=1,n<190&&(n>50?(this.tabs?this.removeLinksTab():this.tabs||(this.search=!this.search,this.toggleSearch(t)),this.taps=0):3!==this.taps||this.tabs||this.search||this.sendMessage({query:"tabs"})),this.taps=this.taps%3?this.taps:0,this.my_latest_tap=s}},{key:"checkKeys",value:function(e,t){var s=this,n=e.key;if("Escape"===n&&(this.search&&(this.search=!1,setTimeout(function(){s.toggleSearch()},0)),this.tabs&&this.removeLinksTab()),"Delete"===n&&this.tabs){var i=document.querySelectorAll(".tab-nav__tab"),a=[].concat(_toConsumableArray(i)).filter(function(e,t){return e.classList.contains("is-active")})[0];a&&a.querySelector(".tab-nav__close").click()}if(t)return"Enter"===n&&(this.updateSuggests(this.element.value),this.openRequest(this.element.value)),void("ArrowUp"!==n&&"ArrowDown"!==n||(this.suggests_show&&(this.selectList(Array.from(this.suggests_collection),n),this.removePlugSuggest()),this.setSelectSuggest(),this.setSeletionRange(e.target)));if(this.keys&&n===this.keys[0]&&(this.pressed[0]=n,setTimeout(function(){s.pressed=[]},500)),n===this.keys[1]&&this.pressed[0]&&!this.tabs&&(this.search=!0,this.pressed=[],this.rewriteProps(),setTimeout(function(){s.toggleSearch()},0)),~this.keys_tabs.indexOf(n)&&this.pressed[0]&&!this.search&&(this.tabs?setTimeout(function(){s.removeLinksTab()},0):setTimeout(function(){s.sendMessage({query:"tabs"})},0)),"ArrowUp"!==n&&"ArrowDown"!==n||!this.tabs||(this.selectList(this.tabs_collection,n),this.scrollTabs(n)),"f"===n&&this.search&&(this.element.focus(),setTimeout(function(){1==s.element.value.length&&(s.element.value="")})),"Enter"===n&&this.tabs){var o=void 0;return e.target.classList.contains("tab-nav__tab")?o=e.target.dataset.id:[].concat(_toConsumableArray(document.querySelectorAll(".tab-nav__tab"))).some(function(e,t){if(e.classList.contains("is-active"))return o=e.dataset.id,!0}),+o}}},{key:"rewriteProps",value:function(){var e=this;return new Promise(function(t,s){chrome.storage.local.get("search_props_",function(s){if(e.sendMessage({query:"storage",key:"search_props_"}),Object.keys(s).length){var n=JSON.parse(s.search_props_);for(var i in n){var a=n[i];e[i]=a}}t()})})}},{key:"toggleShortcutsListImg",value:function(){document.querySelector(".shortcuts-list-img__ul").classList.toggle("is-hidden--fs-search"),document.querySelector(".shortcuts-list-img__arrow").classList.toggle("shortcuts-list-img__arrow--rotate")}},{key:"insertShortcutWithClick",value:function(e){var t=e.dataset.shortcut;this.element.focus(),this.element.value=t+":",this.callCustomEvent(this.element),this.toggleShortcutsListImg()}},{key:"callCustomEvent",value:function(e){var t=this,s=new Event("keyup"),n=function(e){t.appendSearchEngineFavicon(e)};e.addEventListener("keyup",n,!1),e.dispatchEvent(s),e.removeEventListener("keyup",n,!1)}},{key:"appendSearchEngineFavicon",value:function(e){e.key;var t="mdl-textfield__favicon",s=function(s){var n=document.createElement("img");n.onload=function(){e.target.parentNode.appendChild(this),e.target.classList.add("mdl-textfield__input--indent")},n.className=t,n.src=chrome.extension.getURL(s)},n=this.search_engine_data,i=/^([^:]+)(:)?(.*)?$/.exec(e.target.value),a=[],o=[];if(!a.length)for(var r in n)a.push(n[r].shortcut),o.push(n[r].favicon);var l=a.indexOf(i&&i[1]);~l?document.querySelector("."+t)?(l!==this.paste_indx_match&&(this.removeSearchEngineFavicon(e.target),s(o[l])),this.paste_indx_match=l):(s(o[l]),this.paste_indx_match=l):document.querySelector("."+t)&&this.removeSearchEngineFavicon(e.target)}},{key:"removeSearchEngineFavicon",value:function(e){var t=document.querySelector(".mdl-textfield__favicon");return!(!t||(t.remove(),!e))&&(e.classList.remove("mdl-textfield__input--indent"),!0)}},{key:"checkHostname",value:function(){var e=window.location.hostname;return this.exclude_urls.some(function(t,s){return t===e.replace(/^www./,"")})}},{key:"handlerToggleScroll",value:function(){window.scrollTo(0,scroll_pos)}},{key:"toggleScroll",value:function(){window.scroll_pos=document.documentElement.scrollTop,window[this.tabs?"addEventListener":"removeEventListener"]("scroll",this.handlerToggleScroll)}},{key:"toggleSearch",value:function(e){var t=this;if(this.checkHostname())return!1;(this.element.parentNode.parentNode.classList[this.search?"remove":"add"]("is-hidden--fs-search"),this.search||(this.element.value="",this.removeSearchEngineFavicon(this.element),this.removeSuggests()),this.element.parentNode.parentNode.classList.contains("is-hidden--fs-search"))||setTimeout(function(){t.element.focus()},e?350:0);return this.toggleBackground(),!0}},{key:"toggleBackground",value:function(){if(this.background){var e=document.getElementById("f_bg");e.classList[this.search||this.tabs?"remove":"add"]("is-hidden--fs-search"),e.classList[this.bg_animation?"add":"remove"]("layout-bg--animation")}}},{key:"updateSuggests",value:function(e){e=e.replace(/^(.+:)/,"").toLowerCase();var t=this.suggests.findIndex(function(t,s){return e===t.request});if(~t)this.suggests[t].typeCount++;else{var s=Object.assign({},this.suggest);s.request=e;var n=this.suggests.push(s);this.suggests[--n].id=n}this.saveSuggests(),this.getSuggests()}},{key:"getSuggests",value:function(){var e=this;chrome.storage.local.get("suggests",function(t){t.suggests&&t.suggests.length&&(e.suggests=t.suggests)})}},{key:"saveSuggests",value:function(){chrome.storage.local.set({suggests:this.suggests})}},{key:"setSelectSuggest",value:function(){var e=[].concat(_toConsumableArray(this.suggests_collection)).filter(function(e){return e.classList.contains("is-active")})[0];if(e){var t=e.firstElementChild.textContent;this.element.value=this.element.value.replace(/^(.+:)?(.+)/,"$1"+t)}}},{key:"setSeletionRange",value:function(e){var t=e.value.length;setTimeout(function(){e.setSelectionRange(t,t)},0)}},{key:"reindexSuggests",value:function(){var e=this;this.suggest_removed&&(this.suggests.forEach(function(t,s){return e.suggests[s].id=s}),this.saveSuggests(),this.suggest_removed=!1)}},{key:"removeSuggest",value:function(e){var t=e.parentNode.dataset.suggestId,s=this.suggests.findIndex(function(e){return e.id===+t});this.suggests.splice(s,1);var n=document.querySelectorAll(".mdl-textfield__suggests-suggest"),i=[].concat(_toConsumableArray(n)).filter(function(e,s){return e.dataset.suggestId&&+e.dataset.suggestId==+t})[0];i&&(i.innerHTML="ru"===this.lang?"Подсказка удалена":"Suggest removed",i.classList.add("is-remove")),this.suggest_removed=!0}},{key:"removeSuggests",value:function(){var e=document.getElementById("suggests_search");if(parent=e.firstElementChild,parent.childElementCount){for(;parent.firstElementChild;)parent.removeChild(parent.firstElementChild);parent.parentNode.classList.add("is-hidden--fs-search")}this.suggests_collection=[],this.suggests_show=!1,this.reindexSuggests()}},{key:"removePlugSuggest",value:function(){if(this.plug_suggest){var e=document.getElementById("suggests_search").firstElementChild;e.removeChild(e.firstElementChild),this.suggests_collection=document.querySelectorAll(".mdl-textfield__suggests-suggest"),this.plug_suggest=!1}}},{key:"addPlugSuggest",value:function(e,t){if(!t){var s=utils.addElement("li","mdl-textfield__suggests-suggest");e.appendChild(s),this.plug_suggest=!0}}},{key:"buildSuggests",value:function(){var e=this;this.removeSuggests(),this.reindexSuggests();var t=document.getElementById("suggests_search");this.matches_request.length&&(this.matches_request.some(function(s,n){if(n>9)return!0;e.addPlugSuggest(t.firstElementChild,n);var i=utils.addElement("li","mdl-textfield__suggests-suggest",!1,!1,!1,{"data-suggest-id":s.id}),a=utils.addElement("span","mdl-textfield__suggests-text",!1,s.request),o=utils.addElement("button","mdl-textfield__suggests-button",!1,"ru"===e.lang?"Удалить":"Remove",!1);i.appendChild(a),i.appendChild(o),t.firstElementChild.appendChild(i)}),this.suggests_collection=document.querySelectorAll(".mdl-textfield__suggests-suggest"),this.suggests_show||(suggests_search.classList.remove("is-hidden--fs-search"),this.suggests_show=!0))}},{key:"saveMatchesRequest",value:function(e,t){var s=this;if(!(e=e.replace(/^(.+:)/,"").toLowerCase()))return!1;var n=e.split(" ").filter(function(e){return e});return this.matches_request=[],this.suggests.forEach(function(e,t){var i=Object.assign({},e),a=i.request.split(" ").filter(function(e){return e});n.some(function(e,t){var n=e;return a.some(function(e,t){return 0===e.indexOf(n)&&(s.matches_request.push({id:i.id,sort:i.typeCount,request:i.request}),!0)})})}),this.matches_request.sort(function(e,t){return t.sort-e.sort}),!0}},{key:"openRequest",value:function(e){var t=this,s=e,n=this.self?"_self":this.open,i=function(e){var s=t.search_engine_data,n=/^(.+):(.+)/.exec(e);for(var i in s){var a=s[i].shortcut;if(e===a)return s[i];if(n&&n[1]===a)return s[i].url=n[2],s[i].key=i,s[i]}return!1}(s),a=i.origin,o=i.search,r=(i.favicon,i.url),l=i.key,c=a,d=function(e){var s=/^(.+):([^/]+)(.*)?/,n=s.exec(e),i=t.shortcuts.filter(function(t,i){return s.exec(t)[1]===(n?n[1]:e)})[0];return i&&!n?s.exec(i)[2]:!(!i||!n)&&s.exec(i)[2]+s.exec(i)[3]+n[2]}(s),u=function(e){return!!/\.[a-zA-Z]+$/g.test(e)&&/(?:http[s]?:\/\/)?(.+)/i.exec(e)[1]}(s);if(c)window.open(r?a+o+r:a,n),l&&(delete this.search_engine_data[l].url,delete this.search_engine_data[l].key);else if(d)window.open("http://"+d,n);else if(u)window.open("http://"+u,n);else{if(!s)return;var h=this.search_engine_data[this.search_engine],g=h.origin,m=h.search;window.open(g+m+s,n)}this.search=!1,this.toggleSearch()}},{key:"removeLinksTab",value:function(){document.querySelector(".tab-nav").remove(),this.tabs=!1,this.tabs_collection=null,this.toggleScroll(),this.toggleBackground()}},{key:"buildLinksTab",value:function(e){var t=utils.addElement("div","mdl-card fs-search tab-nav mdl-shadow--2dp is-hidden--fs-search"),s=function(e){for(var t=arguments.length,s=Array(t>1?t-1:0),n=1;n<t;n++)s[n-1]=arguments[n];s.forEach(function(t,s){e.appendChild(t)})};e.forEach(function(e,n){var i=utils.addElement("img","tab-nav__favicon");i.src=e.favIconUrl;var a=n+=1,o=utils.addElement("div",e.active?"tab-nav__tab tab-nav__tab--load is-active":"tab-nav__tab tab-nav__tab--load",!1,!1,!1,{tabIndex:a,"data-id":e.id}),r=utils.addElement("span","tab-nav__number",!1,a+"."),l=utils.addElement("span","tab-nav__title",!1,e.title),c=utils.addElement("span","tab-nav__close svg-icon",!1);i.addEventListener("load",function(e){s(o,this,r,l,c),this.parentNode.classList.remove("tab-nav__tab--load")}),i.addEventListener("error",function(e){this.src=chrome.extension.getURL("img/no_favicon.png"),s(o,this,r,l,c),this.parentNode.classList.remove("tab-nav__tab--load")}),t.appendChild(o)}),this.tabs=!0,this.toggleScroll(),this.toggleBackground(),setTimeout(function(){t.classList.remove("is-hidden--fs-search")},10),document.documentElement.appendChild(t),this.tabs_collection=Array.from(document.querySelectorAll(".tab-nav__tab")),this.checkTabOutView()}},{key:"scrollTabs",value:function(e){var t=document.querySelector(".tab-nav"),s=this.tabs_collection.filter(function(e){return e.classList.contains("is-active")})[0],n=s.offsetTop,i=s.offsetHeight,a=function(e,s){if(e>t.clientHeight){var n=e-t.clientHeight,i=s?t.scrollTop-n:t.scrollTop+n;t.scrollTo(0,i)}},o=function(e,s){t.scrollTo(e,s)};if("ArrowDown"===e)n||t.scrollHeight-t.clientHeight!==t.scrollTop?a(n+i):o(0,0);else{var r=t.scrollHeight-(n+i);r||t.scrollTop?a(r+i,!0):o(0,t.scrollHeight-t.clientHeight)}}},{key:"checkTabOutView",value:function(){var e=document.querySelector(".tab-nav"),t=this.tabs_collection.filter(function(e){return e.classList.contains("is-active")})[0],s=t.offsetTop+t.offsetHeight-e.clientHeight;s&&e.scrollTo(0,s)}},{key:"selectList",value:function(e,t){if(!e||!e.length)return!1;var s=0,n=new Array(e.length);e.forEach(function(e,t){e.classList.contains("is-active")?(s=t,n[t]=1):n[t]=0});var i=s;n[i]=0,"ArrowDown"===t?n[++i<=e.length-1?i:0]=1:n[-1==--i?e.length-1:i]=1;var a=n.indexOf(1);e[s].classList.remove("is-active"),e[a].classList.add("is-active")}},{key:"removeLinkTab",value:function(e){var t=this.tabs_collection.findIndex(function(t){return t.dataset.id==e});this.selectList(this.tabs_collection,"ArrowDown"),document.querySelector('div[data-id="'+e+'"]').remove(),this.tabs_collection.splice(t,1)}},{key:"sendMessage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};chrome.runtime.sendMessage(t,function(s){"tabs"===t.query&&e.buildLinksTab(s),"tab_removed"===s.action&&e.removeLinkTab(s.data),"update"===s.action&&e.removeLinksTab()})}},{key:"getMessage",value:function(){var e=this;chrome.runtime.onMessage.addListener(function(t){t&&"change_tab"===t.action&&e.tabs&&e.removeLinksTab()})}},{key:"storageClear",value:function(){chrome.storage.local.clear()}},{key:"onbeforeunload",value:function(){var e=this;window.onbeforeunload=function(){e.reindexSuggests()}}}]),e}(),srch=new Search;srch.rewriteProps().then(function(e){srch.addPrefixLangSearchEngine(),srch.appendBackground(),srch.appendSearch(),srch.getMessage(),srch.docEvents(),srch.getSuggests(),srch.onbeforeunload()},function(e){return console.log(e.message)});
//# sourceMappingURL=maps/bundle.content.min.js.map
